(this["webpackJsonpreimagined-garbanzo"]=this["webpackJsonpreimagined-garbanzo"]||[]).push([[0],{14:function(e,t,a){},15:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n,r,c=a(0),o=a.n(c),i=a(7),s=a.n(i),u=(a(14),a(8)),l=(a(15),{dispatch:function(){throw new Error("Create Covid19Context dispatch with useReducer")},state:{timeFrame:0,data:{}}}),E=Object(c.createContext)(l),d=function(){return Object(c.useContext)(E).dispatch},m=function(){return Object(c.useContext)(E).state},f=a(2),A=a(1),v=a(3);!function(e){e[e.AREA_DATA_REQUESTED=0]="AREA_DATA_REQUESTED",e[e.AREA_DATA_REJECTED=1]="AREA_DATA_REJECTED",e[e.AREA_DATA_RESOLVED=2]="AREA_DATA_RESOLVED",e[e.TIME_FRAME_CHANGED=3]="TIME_FRAME_CHANGED"}(n||(n={})),function(e){e[e.FETCHING=0]="FETCHING",e[e.COMPLETE=1]="COMPLETE",e[e.ERROR=2]="ERROR"}(r||(r={}));var O,h=function e(t){Object(v.a)(this,e),this.type=n.AREA_DATA_REJECTED,this.area=void 0,this.area=t},p=function(e,t){return Object(A.a)(Object(A.a)({},e),{},{data:Object(A.a)(Object(A.a)({},e.data),{},Object(f.a)({},t.area,{status:r.ERROR}))})},R=function e(t){Object(v.a)(this,e),this.type=n.AREA_DATA_REQUESTED,this.area=void 0,this.area=t},T=function(e,t){return Object(A.a)(Object(A.a)({},e),{},{data:Object(A.a)(Object(A.a)({},e.data),{},Object(f.a)({},t.area,{status:r.FETCHING}))})},b=function e(t,a){Object(v.a)(this,e),this.type=n.AREA_DATA_RESOLVED,this.area=void 0,this.data=void 0,this.area=t,this.data=a},D=function(e,t){return Object(A.a)(Object(A.a)({},e),{},{data:Object(A.a)(Object(A.a)({},e.data),{},Object(f.a)({},t.area,{status:r.COMPLETE,data:t.data}))})},C=function e(t){Object(v.a)(this,e),this.type=n.TIME_FRAME_CHANGED,this.timeFrame=void 0,this.timeFrame=t},j=function(e,t){return Object(A.a)(Object(A.a)({},e),{},{timeFrame:t.timeFrame})},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{timeFrame:0,data:{}},t=arguments.length>1?arguments[1]:void 0;if(void 0===t)return e;switch(t.type){case n.AREA_DATA_REQUESTED:return T(e,t);case n.AREA_DATA_REJECTED:return p(e,t);case n.AREA_DATA_RESOLVED:return D(e,t);case n.TIME_FRAME_CHANGED:return j(e,t);default:return e}};!function(e){e.Bolton="Bolton",e.Bury="Bury",e.Manchester="Manchester",e.Oldham="Oldham",e.Rochdale="Rochdale",e.Salford="Salford",e.Stockport="Stockport",e.Tameside="Tameside",e.Trafford="Trafford",e.Wigan="Wigan"}(O||(O={}));var N,w=function(e){var t=e.backgroundColor,a=void 0===t?"transparent":t,n=e.area;return o.a.createElement("div",{className:"node"},o.a.createElement("div",{className:"node-top",style:{borderBottomColor:a},"data-testid":"node-top"}),o.a.createElement("div",{className:"node-bottom",style:{borderTopColor:a},"data-testid":"node-bottom"}),void 0!==n&&o.a.createElement("div",{className:"node-text"},n))},g=function(){return m().timeFrame},S=a(4),y=a.n(S),M=a(5);!function(e){e[e.PRODUCTION=0]="PRODUCTION",e[e.STAGING=1]="STAGING"}(N||(N={}));var I=function(){return N.PRODUCTION},F="https://api.coronavirus.data.gov.uk/v1/data",x="https://api.coronavirus-staging.data.gov.uk/v1/data";function G(e){return k.apply(this,arguments)}function k(){return(k=Object(M.a)(y.a.mark((function e(t){var a,n,r,c,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=I()===N.PRODUCTION?F:x,n="".concat(a,"?filters=areaType=ltla;areaName=").concat(t,'&structure={"date":"date","newCasesBySpecimenDate":"newCasesBySpecimenDate"}'),e.next=4,fetch(n);case 4:return r=e.sent,e.next=7,r.json();case 7:return c=e.sent,o=c.data,e.abrupt("return",o);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var B=function(e){var t=e.area,a=function(e){var t,a,n=d(),o=m();return Object(c.useEffect)((function(){n(new R(e)),Object(M.a)(y.a.mark((function t(){var a;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,G(e);case 3:a=t.sent,n(new b(e,a)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n(new h(e));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()}),[e,n]),{status:(null===(t=o.data[e])||void 0===t?void 0:t.status)||r.FETCHING,data:(null===(a=o.data[e])||void 0===a?void 0:a.data)||[]}}(t),n=a.status,i=a.data,s=g(),u=Object(c.useMemo)((function(){return n===r.FETCHING?"#eef":n===r.ERROR?"#fee":!i||s>=i.length?"#eee":"rgb(".concat(Math.max(0,255-(3^i[s].newCasesBySpecimenDate)),", 255, 255)")}),[n,i,s]);return o.a.createElement(w,{backgroundColor:u,area:t})},H=function(){return o.a.createElement(w,null)},U=function(){return o.a.createElement("div",{className:"node-canvas"},o.a.createElement("div",{className:"node-row"},o.a.createElement(H,null)),o.a.createElement("div",{className:"node-row"},o.a.createElement(B,{area:O.Bolton}),o.a.createElement(B,{area:O.Rochdale}),o.a.createElement(H,null)),o.a.createElement("div",{className:"node-row"},o.a.createElement(B,{area:O.Wigan}),o.a.createElement(B,{area:O.Bury}),o.a.createElement(H,null)),o.a.createElement("div",{className:"node-row"},o.a.createElement(B,{area:O.Salford}),o.a.createElement(B,{area:O.Oldham}),o.a.createElement(H,null)),o.a.createElement("div",{className:"node-row"},o.a.createElement(H,null),o.a.createElement(B,{area:O.Manchester}),o.a.createElement(B,{area:O.Tameside})),o.a.createElement("div",{className:"node-row"},o.a.createElement(B,{area:O.Trafford}),o.a.createElement(B,{area:O.Stockport}),o.a.createElement(H,null)),o.a.createElement("div",{className:"node-row"},o.a.createElement(H,null)))},P=Date.UTC(2020,2,1),L=function(){var e=d(),t=g(),a=Math.floor((Date.now()-P)/864e5);return o.a.createElement("div",{className:"time-frame-control"},o.a.createElement("div",null,new Date(P+864e5*t).toISOString().substring(0,10)),o.a.createElement("input",{type:"range","aria-label":"input-range",onChange:function(t){t.preventDefault(),e(new C(parseInt(t.target.value)))},value:t,min:"0",max:a}))},J=function(){var e=Object(c.useReducer)(_,{timeFrame:0,data:{}}),t=Object(u.a)(e,2),a=t[0],n=t[1],r=Object(c.useMemo)((function(){return{dispatch:n,state:a}}),[n,a]);return o.a.createElement("div",{className:"App",style:{textAlign:"center"}},o.a.createElement(E.Provider,{value:r},o.a.createElement(U,null),o.a.createElement(L,null)))};s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(J,null)),document.getElementById("root"))},9:function(e,t,a){e.exports=a(17)}},[[9,1,2]]]);
//# sourceMappingURL=main.16a63ebe.chunk.js.map